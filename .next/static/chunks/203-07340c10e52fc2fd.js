"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{6203:function(e,a,t){var l=t(7437),i=t(2265),r=t(3514),o=t(4175),s=t(3787),n=t(933),c=t(4042),d=t(9402),m=t(3541),g=t(5066),h=t(6017),u=t(7017),p=t(7138),x=t(4058),f=t(3580),v=t(6463);let b=["Europe/Paris","America/New_York","America/Los_Angeles","Australia/Sydney","Asia/Tokyo","Europe/London","America/Chicago","Asia/Shanghai","America/Toronto","Europe/Berlin","America/Mexico_City","America/Sao_Paulo","Africa/Johannesburg","Asia/Dubai","Pacific/Auckland"];a.Z=e=>{let{type:a}=e;(0,v.useSearchParams)();let t=localStorage.getItem("timezone"),y=(0,h.TL)(),{loading:j,citiesData:C,mergeCitiesData:w,error:N,currentPage:S,totalItems:z,searchTerm:_,timeZone:A,pageLimit:T,theme:D,favCityData:I,order:k,orderField:L}=(0,h.CG)(e=>e.cities),[Z,M]=(0,i.useState)(null),[$,J]=(0,i.useState)("ASC"),[P,E]=(0,i.useState)(""),[F,O]=(0,i.useState)(t||A||""),K=e=>{let{ascii_name:a,cou_name_en:t,population:l,timezone:i,coordinates:r}=e.row.original,o=localStorage.getItem("favCity"),s=o?JSON.parse(o):[];if(s.find(e=>e.ascii_name===a)){(0,f.Am)("City already added to favorites",{theme:D,type:"error"});return}s.push({ascii_name:a,cou_name_en:t,population:l,timezone:i,coordinates:r}),localStorage.setItem("favCity",JSON.stringify(s)),y((0,x.j$)(JSON.parse(localStorage.getItem("favCity")))),(0,f.Am)("City added to favorites",{theme:D,type:"success"})},R=e=>{let{ascii_name:a}=e.row.original,t=localStorage.getItem("favCity"),l=(t?JSON.parse(t):[]).filter(e=>e.ascii_name!==a);localStorage.setItem("favCity",JSON.stringify(l)),y((0,x.j$)(JSON.parse(localStorage.getItem("favCity")))),(0,f.Am)("City removed from favorites",{theme:D,type:"success"})},G=()=>{if("all"===a){y((0,x.M$)([]));let e={page:S,limit:T,timezone:A,searchTerm:_,order:"ascii_name%20".concat(k&&"ASC"===k.split("%20")[1]?"DESC":"ASC")};y((0,u.j)(e))}else{let e=JSON.parse(localStorage.getItem("favCity")||"[]"),a=e.sort((e,a)=>"ASC"===$?e.ascii_name<a.ascii_name?-1:e.ascii_name>a.ascii_name?1:0:e.ascii_name>a.ascii_name?-1:e.ascii_name<a.ascii_name?1:0);e.length>0?y((0,x.j$)(a)):M("No data found")}},V=(0,r.b7)({data:"all"===a?w:Z?[]:I,columns:[{accessorKey:"ascii_name",header:"City Name",size:200,cell:e=>{let{coordinates:a}=e.row.original,t=a?a.lat:null,i=a?a.lon:null;return(0,l.jsx)("div",{className:"w-full",children:(0,l.jsxs)(p.default,{href:"/weather/".concat(e.getValue(),"?lat=").concat(t,"&lng=").concat(i),className:"flex items-center gap-1 hover:text-blue-500 hover:underline",target:"_blank",rel:"noreferrer",children:[e.getValue(),(0,l.jsx)(s.Z,{size:16})]})})}},{accessorKey:"cou_name_en",header:"Country",size:200,enableSorting:!1},{accessorKey:"timezone",header:"Timezone",enableSorting:!1,cell:e=>(0,l.jsxs)("div",{className:"p-2 px-3 gap-1 flex items-center inset-2 capitalize text-xs w-fit font-medium rounded-full bg-gradient-to-tr from-purple-500 to-blue-400 text-white",children:[(0,l.jsx)(n.Z,{size:16}),e.getValue()]}),size:200},{accessorKey:"population",header:"Population",size:200},{accessorKey:"action",header:"Action",size:200,cell:e=>(0,l.jsx)("div",{className:"flex items-center gap-2",children:"all"===a?(0,l.jsx)("button",{type:"button",onClick:()=>K(e),className:"text-red-500 hover:text-red-400 hover:underline flex items-center gap-2 text-sm",children:I.some(a=>a.ascii_name===e.row.original.ascii_name)?(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.Z,{size:16,fill:"red"})," ",(0,l.jsx)("em",{className:"text-red-300",children:"Added to favorites"})]}):(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.Z,{size:16})," Add to favorites"]})}):(0,l.jsxs)("button",{type:"button",onClick:()=>R(e),className:"text-red-500 hover:text-red-400 hover:underline flex items-center gap-2 text-sm",children:[(0,l.jsx)(d.Z,{size:16}),"Remove from favorites"]})})}],getCoreRowModel:(0,o.sC)()});(0,i.useEffect)(()=>{if("all"===a){let e=()=>{window.innerHeight+window.scrollY>=document.body.scrollHeight&&y((0,u.j)({page:S+1,limit:T,timezone:A,searchTerm:P,order:k}))};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}}},[C,S,y]),(0,i.useEffect)(()=>{localStorage.setItem("timezone",A||"Asia/Kolkata"),y((0,u.j)({page:1,limit:20,timezone:t||A||"Asia/Kolkata",searchTerm:"",order:k}))},[]);let H=e=>{let a=JSON.parse(localStorage.getItem("history"));return a&&a.length>0?a.find(a=>a.city.toLowerCase()===e.split(" ").join("%20").toLowerCase()):null};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"w-full mt-6 flex flex-col md:flex-row items-center gap-3",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1 border-zinc-400  p-4 box-border border ".concat("light"===D?"bg-zinc-400/60":"bg-zinc-700/60"," rounded-lg"),children:[(0,l.jsx)("label",{htmlFor:"search",children:"Search by any city name"}),"all"===a&&(0,l.jsx)("p",{className:"text-xs text-red-400",children:"This search filter is independent of timezone"}),(0,l.jsx)("input",{type:"text",name:"search",id:"search",className:"border border-blue-300 p-2 rounded-md w-[300px] ".concat("light"===D?"bg-white":"bg-slate-700"),value:P,onChange:e=>{let{value:t}=e.target;if(E(t),t.length>2){if("all"===a)y((0,x.M$)([])),y((0,u.j)({page:1,limit:20,timezone:A,searchTerm:t,order:k}));else{let e=JSON.parse(localStorage.getItem("favCity")||"[]").filter(e=>e.ascii_name.toLowerCase().includes(t.toLowerCase()));e.length>0?y((0,x.j$)(e)):M("No data found")}}if(0===t.length){if("all"===a)y((0,u.j)({page:1,limit:20,timezone:A,searchTerm:""}));else{let e=JSON.parse(localStorage.getItem("favCity")||"[]");y((0,x.j$)(e))}}},placeholder:"Type full city name.."})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 border-zinc-400 p-4 box-border border ".concat("light"===D?"bg-zinc-400/60":"bg-zinc-700/60"," rounded-lg"),children:[(0,l.jsx)("label",{htmlFor:"search",children:"Filter by TimeZones"}),"all"===a&&(0,l.jsx)("p",{className:"text-xs text-red-400",children:'Default timezone is "Asia/Kolkata"'}),(0,l.jsxs)("select",{name:"timezone",id:"timezone",className:"border border-blue-300 p-2 rounded-md w-[300px] cursor-pointer ".concat("light"===D?"bg-white":"bg-slate-700"),value:F,onChange:e=>{let{value:t}=e.target;if(O(t),localStorage.setItem("timezone",t),"all"===a)y((0,x.M$)([])),y((0,u.j)({page:1,limit:20,timezone:t,searchTerm:_,order:k}));else{let e=JSON.parse(localStorage.getItem("favCity")||"[]");if("all"===t)y((0,x.j$)(e));else{y((0,x.j$)(e));let a=e.filter(e=>e.timezone===t);e.length>0?y((0,x.j$)(a)):M("No data found")}}},children:[(0,l.jsx)("option",{value:"Asia/Kolkata",children:"Asia/Kolkata"}),"fav"===a&&(0,l.jsx)("option",{value:"all",children:"All"}),b.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})]}),(0,l.jsx)("div",{className:"w-full rounded-md border-x mt-6 border-slate-300 overflow-auto",children:(0,l.jsxs)("table",{className:"w-full border-0 border-collapse ".concat("light"===D?"bg-white":"bg-slate-700"),children:[(0,l.jsx)("thead",{children:V.getHeaderGroups().map(e=>(0,l.jsx)("tr",{className:"border border-slate-500 ".concat("light"===D?"bg-slate-700":"bg-slate-800"," text-white"),children:e.headers.map(e=>(0,l.jsx)("th",{colSpan:e.colSpan,className:"whitespace-nowrap text-left p-3 font-medium",style:{width:e.getSize()},children:e.isPlaceholder?null:(0,l.jsxs)("div",{className:"select-none flex items-center gap-1",children:[(0,r.ie)(e.column.columnDef.header,e.getContext()),"City Name"===e.column.columnDef.header&&(0,l.jsx)("span",{className:"cursor-pointer hover:text-blue-500",onClick:()=>{G(),J(e=>"ASC"===e?"DESC":"ASC")},children:(null==k?void 0:k.split("%20")[1])==="ASC"?(0,l.jsx)(m.Z,{size:18}):(0,l.jsx)(g.Z,{size:18})})]})},e.id))},e.id))}),(0,l.jsx)("tbody",{children:V.getRowModel().rows.map(e=>(0,l.jsx)("tr",{className:"border-b border-slate-300 cursor-pointer ".concat("light"===D?"hover:bg-slate-200":"hover:bg-slate-800"," ease-in-out duration-200"),children:e.getVisibleCells().map(e=>{var a,t;return(0,l.jsxs)("td",{className:"p-3 truncate",style:{maxWidth:e.column.getSize()},children:[(0,r.ie)(e.column.columnDef.cell,e.getContext()),"ascii_name"===e.column.id&&H(e.row.original.ascii_name)&&(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"Already visited"}),(0,l.jsxs)("div",{className:"w-full flex gap-2",children:[(0,l.jsxs)("span",{className:"text-gray-500 text-xs",children:["Max Temp:",((null===(a=H(e.row.original.ascii_name))||void 0===a?void 0:a.maxTemp)-273.15).toFixed(2),"\xb0C"]}),(0,l.jsxs)("span",{className:"text-gray-500 text-xs",children:["Min Temp:",((null===(t=H(e.row.original.ascii_name))||void 0===t?void 0:t.maxTemp)-273.15).toFixed(2),"\xb0C"]})]})]})]},e.id)})},e.id))})]})}),(0,l.jsx)("div",{className:"w-full",children:j&&(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-2 ".concat("light"===D?"bg-white":"bg-slate-600"," p-2 rounded-md"),children:[(0,l.jsx)("div",{className:"".concat("light"===D?"bg-gray-200":"bg-slate-700"," animate-pulse p-6")}),(0,l.jsx)("div",{className:"".concat("light"===D?"bg-gray-200":"bg-slate-700"," animate-pulse p-6")}),(0,l.jsx)("div",{className:"".concat("light"===D?"bg-gray-200":"bg-slate-700"," animate-pulse p-6")}),(0,l.jsx)("div",{className:"".concat("light"===D?"bg-gray-200":"bg-slate-700"," animate-pulse p-6")})]})}),"all"===a&&0===C.length&&N&&(0,l.jsx)("div",{className:"w-full rounded-xl border border-dashed border-slate-300 p-4",children:(0,l.jsx)("h1",{children:"No Data Available"})}),"fav"===a&&0===I.length&&(0,l.jsx)("div",{className:"w-full rounded-b-lg text-red-400 border border-dashed border-red-300 bg-white p-4",children:(0,l.jsx)("h1",{children:"No Data Available"})}),"fav"===a&&Z&&(0,l.jsx)("div",{className:"w-full rounded-b-lg text-red-400 border border-dashed border-red-300 bg-white p-4",children:(0,l.jsx)("h1",{children:Z})})]})}},6017:function(e,a,t){t.d(a,{CG:function(){return r},TL:function(){return i}});var l=t(1444);let i=l.I0.withTypes(),r=l.v9.withTypes();l.oR.withTypes()},7017:function(e,a,t){t.d(a,{j:function(){return l}});let l=(0,t(9753).hg)("fetchGeonameData",async e=>{console.log(e);{let a;a=e.searchTerm&&e.searchTerm.length>0?"".concat("https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/records","?where=ascii_name%20like%20%22").concat(e.searchTerm,"%22"):"".concat("https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/records","?limit=").concat(e.limit,"&offset=").concat(e.page,"&refine=timezone:").concat(e.timezone),e.order&&(console.log(e.order),a=a.replace("?","?&order_by=".concat(e.order,"&"))),console.log(a);let t=await fetch(a),l=await t.json();return{data:l.results,totalItems:l.total_count,timezone:e.timezone,pageLimit:e.limit,currentPage:e.page,searchTerm:e.searchTerm,order:e.order,orderField:e.order?"ascii_name"===e.order.split("%20")[0]?"City Name":"Population":""}}})},4058:function(e,a,t){t.d(a,{Dc:function(){return n},It:function(){return d},M$:function(){return s},j$:function(){return c}});var l=t(9753),i=t(7017);let r=e=>{console.log(e);let a=new Set,t=[];for(let l=0;l<e.length;l++)a.has(e[l].geoname_id)||(a.add(e[l].geoname_id),t.push(e[l]));return console.log(t),t},o=(0,l.oM)({name:"cities",initialState:{loading:!1,citiesData:[],totalMergeCount:0,mergeCitiesData:[],error:null,currentPage:1,totalItems:0,timeZone:"",pageLimit:20,searchTerm:"",order:"ascii_name%20ASC",orderField:"City Name",theme:"light",favCityData:[]},reducers:{setCitiesData:(e,a)=>({...e,totalMergeCount:a.payload.length,mergeCitiesData:a.payload}),setTheme:(e,a)=>(localStorage.setItem("theme",a.payload),{...e,theme:a.payload}),setFavCityData:(e,a)=>({...e,favCityData:a.payload}),setTimeZone:(e,a)=>({...e,timeZone:a.payload})},extraReducers:e=>{e.addCase(i.j.pending,e=>{e.loading=!0}),e.addCase(i.j.fulfilled.type,(e,a)=>{var t,l,i,o,s,n,c,d,m,g;e.loading=!1,e.citiesData=null===(t=a.payload)||void 0===t?void 0:t.data,e.totalMergeCount=e.mergeCitiesData.length,e.mergeCitiesData=e.searchTerm?r(null===(l=a.payload)||void 0===l?void 0:l.data):r([...e.mergeCitiesData,...null===(i=a.payload)||void 0===i?void 0:i.data]),e.totalItems=null===(o=a.payload)||void 0===o?void 0:o.totalItems,e.timeZone=null===(s=a.payload)||void 0===s?void 0:s.timezone,e.pageLimit=null===(n=a.payload)||void 0===n?void 0:n.pageLimit,e.currentPage=null===(c=a.payload)||void 0===c?void 0:c.currentPage,e.searchTerm=null===(d=a.payload)||void 0===d?void 0:d.searchTerm,e.order=null===(m=a.payload)||void 0===m?void 0:m.order,e.orderField=null===(g=a.payload)||void 0===g?void 0:g.orderField,e.error=null}),e.addCase(i.j.rejected,e=>{e.loading=!1,e.citiesData=[],e.error="Something went wrong"})}}),{setCitiesData:s,setTheme:n,setFavCityData:c,setTimeZone:d}=o.actions;a.ZP=o.reducer}}]);